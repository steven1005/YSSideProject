<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oracle SQL 詳盡入門與進階教學</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>body{padding:1.5rem;} h1{border-bottom: 1px solid #555; padding-bottom: 5px; margin-top: 2rem;} pre, code{font-size: 1.1em !important; background-color: #333; padding: 1rem; border-radius: 5px; color: #eee; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; word-break: break-all;}</style>
</head>
<body class="p-3 bg-dark text-white">
    <h1 class="mb-4">Oracle SQL 詳盡入門與進階教學</h1>
    <p>本教學旨在為初學者提供一個全面而詳細的 Oracle SQL 入門指引，並逐步深入到更進階的應用。</p>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">1: SELECT - 資料查詢的基礎與進階</h1>
    <p><code>SELECT</code> 是 SQL 中最基本也最重要的指令，用於從資料庫中擷取資料。您可以選擇所有欄位 (<code>*</code>) 或指定特定欄位。進階應用包括使用 <code>DISTINCT</code> 移除重複值，以及使用算術運算子。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：基本與進階 SELECT</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 選取 employees 資料表的所有欄位
SELECT * FROM employees;

-- 只選取員工的名字、薪水，並使用 AS 為欄位取別名
SELECT first_name AS 員工姓名, salary AS 員工薪水 FROM employees;

-- 選取不重複的部門 ID
SELECT DISTINCT department_id FROM employees;

-- 計算年薪 (假設薪水是月薪)
SELECT first_name, salary, salary * 12 AS annual_salary FROM employees;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">2: WHERE - 條件過濾與多重條件</h1>
    <p><code>WHERE</code> 子句用於過濾記錄，只回傳符合特定條件的資料。您可以使用各種比較運算子 (<code>=, &gt;, &lt;, &lt;=, &gt;=, &lt;&gt;</code>) 和邏輯運算子 (<code>AND, OR, NOT</code>) 來組合多重條件。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：WHERE 子句應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 尋找薪水大於 10000 且部門 ID 為 90 的員工
SELECT * FROM employees WHERE salary &gt; 10000 AND department_id = 90;

-- 尋找薪水在 5000 到 8000 之間的員工
SELECT first_name, salary FROM employees WHERE salary BETWEEN 5000 AND 8000;

-- 尋找部門 ID 為 60, 90, 100 的員工
SELECT first_name, department_id FROM employees WHERE department_id IN (60, 90, 100);

-- 尋找名字以 'S' 開頭的員工 (大小寫敏感，取決於資料庫設定)
SELECT first_name FROM employees WHERE first_name LIKE 'S%';

-- 尋找 commission_pct 為 NULL 的員工
SELECT first_name, commission_pct FROM employees WHERE commission_pct IS NULL;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">3: ORDER BY - 結果排序與多欄位排序</h1>
    <p><code>ORDER BY</code> 子句用於對查詢結果進行排序。預設為升冪 (<code>ASC</code>)，您也可以指定為降冪 (<code>DESC</code>)。您可以根據一個或多個欄位進行排序。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：ORDER BY 子句應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 依薪水由高到低排序
SELECT first_name, salary FROM employees ORDER BY salary DESC;

-- 先依部門 ID 升冪排序，再依薪水降冪排序
SELECT first_name, department_id, salary FROM employees ORDER BY department_id ASC, salary DESC;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">4: JOIN - 關聯資料表與不同 JOIN 類型</h1>
    <p>在關聯式資料庫中，資料通常分散在多個資料表中。<code>JOIN</code> 用於將這些資料表根據共通欄位結合起來。主要有 <code>INNER JOIN</code>, <code>LEFT JOIN</code>, <code>RIGHT JOIN</code>, <code>FULL OUTER JOIN</code>。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：不同 JOIN 類型</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- INNER JOIN: 只回傳兩個資料表中都有匹配的記錄
SELECT e.first_name, d.department_name
FROM employees e
INNER JOIN departments d ON e.department_id = d.department_id;

-- LEFT JOIN: 回傳左表所有記錄，以及右表匹配的記錄。如果右表沒有匹配，則右表欄位為 NULL
SELECT e.first_name, d.department_name
FROM employees e
LEFT JOIN departments d ON e.department_id = d.department_id;

-- RIGHT JOIN: 回傳右表所有記錄，以及左表匹配的記錄。如果左表沒有匹配，則左表欄位為 NULL
SELECT e.first_name, d.department_name
FROM employees e
RIGHT JOIN departments d ON e.department_id = d.department_id;

-- FULL OUTER JOIN: 回傳左表和右表所有記錄。如果沒有匹配，則另一邊的欄位為 NULL
-- 注意：Oracle 12c 之前可能需要使用 UNION ALL 模擬
SELECT e.first_name, d.department_name
FROM employees e
FULL OUTER JOIN departments d ON e.department_id = d.department_id;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">5: GROUP BY 與 HAVING - 資料分組與過濾</h1>
    <p><code>GROUP BY</code> 將具有相同值的資料列分組，並常與彙總函式 (Aggregate Functions) 一起使用。<code>HAVING</code> 則用於過濾分組後的結果，它類似於 <code>WHERE</code>，但作用於分組後的結果。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：GROUP BY 與 HAVING 應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 計算每個部門的平均薪水，且只顯示平均薪水大於 8000 的部門
SELECT department_id, AVG(salary) AS avg_salary
FROM employees
GROUP BY department_id
HAVING AVG(salary) &gt; 8000
ORDER BY avg_salary DESC;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">6: INSERT - 新增資料與多種方式</h1>
    <p><code>INSERT INTO</code> 語句用於向資料表中新增一筆或多筆新的記錄。您可以指定欄位，也可以不指定（但必須按順序提供所有欄位的值）。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：INSERT 語句應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 插入單筆記錄，指定欄位
INSERT INTO employees (employee_id, first_name, last_name, email, hire_date, job_id, salary)
VALUES (207, 'John', 'Doe', 'JDOE', SYSDATE, 'IT_PROG', 6000);

-- 插入單筆記錄，不指定欄位 (必須提供所有欄位的值，且順序正確)
-- 假設 employees 表的欄位順序為：employee_id, first_name, last_name, email, phone_number, hire_date, job_id, salary, commission_pct, manager_id, department_id
-- INSERT INTO employees VALUES (208, 'Jane', 'Smith', 'JSMITH', NULL, SYSDATE, 'SA_REP', 7000, NULL, 145, 80);

-- 透過 SELECT 語句插入多筆記錄
INSERT INTO employees_archive (employee_id, first_name, last_name)
SELECT employee_id, first_name, last_name FROM employees WHERE hire_date &lt; TO_DATE('2000-01-01', 'YYYY-MM-DD');</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">7: UPDATE - 更新資料與多欄位更新</h1>
    <p><code>UPDATE</code> 語句用於修改資料表中的現有記錄。請務必搭配 <code>WHERE</code> 子句使用，否則會更新整個資料表！您可以一次更新一個或多個欄位。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：UPDATE 語句應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 更新員工 ID 為 101 的薪水和電子郵件
UPDATE employees
SET salary = 50000, email = 'NEW_EMAIL'
WHERE employee_id = 101;

-- 根據另一個資料表的資料來更新
UPDATE employees e
SET e.salary = (SELECT j.max_salary FROM jobs j WHERE e.job_id = j.job_id)
WHERE e.salary &lt; (SELECT j.max_salary FROM jobs j WHERE e.job_id = j.job_id);</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">8: DELETE - 刪除資料與 TRUNCATE</h1>
    <p><code>DELETE</code> 語句用於刪除資料表中的記錄。同樣地，請務必搭配 <code>WHERE</code> 子句使用。<code>TRUNCATE TABLE</code> 則用於快速刪除資料表中的所有記錄，但它是一個 DDL (Data Definition Language) 操作，不能回滾。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：DELETE 與 TRUNCATE</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 刪除部門 ID 為 110 的所有員工
DELETE FROM employees WHERE department_id = 110;

-- 刪除所有員工 (非常危險，無 WHERE 子句)
-- DELETE FROM employees;

-- 快速刪除資料表所有資料 (不能回滾)
-- TRUNCATE TABLE employees_temp;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">9: CREATE TABLE - 建立資料表與約束</h1>
    <p><code>CREATE TABLE</code> 用於在資料庫中建立新的資料表。您需要定義欄位名稱、資料型別以及約束 (Constraints)，如 <code>PRIMARY KEY</code>, <code>FOREIGN KEY</code>, <code>NOT NULL</code>, <code>UNIQUE</code>, <code>CHECK</code>。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：CREATE TABLE 語句應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>CREATE TABLE products (
    product_id NUMBER(6) PRIMARY KEY, -- 主鍵
    product_name VARCHAR2(100) NOT NULL UNIQUE, -- 非空且唯一
    price NUMBER(8, 2) CHECK (price &gt; 0), -- 價格必須大於 0
    category_id NUMBER(4),
    CONSTRAINT fk_category FOREIGN KEY (category_id) REFERENCES categories(category_id) -- 外鍵
);

CREATE TABLE categories (
    category_id NUMBER(4) PRIMARY KEY,
    category_name VARCHAR2(50) NOT NULL
);</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">10: Oracle 常用函式</h1>
    <p>Oracle 提供了豐富的內建函式來處理資料。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：常用函式</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 字串函式: 將名字轉為大寫，並連接姓氏
SELECT UPPER(first_name) || ' ' || UPPER(last_name) AS full_name FROM employees;

-- 數值函式: 將薪水四捨五入到千位
SELECT salary, ROUND(salary, -3) FROM employees;

-- 日期函式: 取得目前系統日期，並格式化顯示
SELECT SYSDATE, TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') AS current_time FROM dual;

-- 轉換函式: 將字串轉為日期
SELECT TO_DATE('2023-01-15', 'YYYY-MM-DD') FROM dual;

-- 條件表達式: CASE 語句
SELECT first_name, salary,
       CASE
           WHEN salary &lt; 5000 THEN '低薪'
           WHEN salary BETWEEN 5000 AND 10000 THEN '中薪'
           ELSE '高薪'
       END AS salary_level
FROM employees;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">11: 子查詢 (Subqueries) - 巢狀查詢</h1>
    <p>子查詢是嵌套在另一個 SQL 查詢中的查詢。它可以用於 <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code>, <code>HAVING</code> 子句中，提供資料給主查詢。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：子查詢應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 尋找薪水高於平均薪水的員工
SELECT first_name, salary
FROM employees
WHERE salary &gt; (SELECT AVG(salary) FROM employees);

-- 尋找在 'IT' 部門工作的員工
SELECT first_name, department_id
FROM employees
WHERE department_id IN (SELECT department_id FROM departments WHERE department_name = 'IT');

-- 在 FROM 子句中使用子查詢 (內聯視圖)
SELECT a.department_name, a.avg_salary
FROM (
    SELECT department_id, AVG(salary) AS avg_salary
    FROM employees
    GROUP BY department_id
) a
JOIN departments d ON a.department_id = d.department_id
WHERE a.avg_salary &gt; 7000;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">12: 集合運算子 (Set Operators) - 合併查詢結果</h1>
    <p>集合運算子用於合併兩個或多個 <code>SELECT</code> 語句的結果。主要有 <code>UNION</code>, <code>UNION ALL</code>, <code>INTERSECT</code>, <code>MINUS</code>。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：集合運算子應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- UNION: 合併結果並移除重複行
SELECT employee_id, first_name FROM employees WHERE department_id = 60
UNION
SELECT employee_id, first_name FROM employees WHERE job_id = 'IT_PROG';

-- UNION ALL: 合併結果並保留所有重複行
SELECT employee_id, first_name FROM employees WHERE department_id = 60
UNION ALL
SELECT employee_id, first_name FROM employees WHERE job_id = 'IT_PROG';

-- INTERSECT: 回傳兩個查詢結果的共同行
SELECT employee_id, first_name FROM employees WHERE department_id = 60
INTERSECT
SELECT employee_id, first_name FROM employees WHERE job_id = 'IT_PROG';

-- MINUS: 回傳第一個查詢結果中存在，但第二個查詢結果中不存在的行
SELECT employee_id, first_name FROM employees WHERE department_id = 60
MINUS
SELECT employee_id, first_name FROM employees WHERE job_id = 'IT_PROG';</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">13: 序列 (Sequences) - 自動生成唯一數字</h1>
    <p>序列是 Oracle 資料庫物件，用於自動生成唯一的數字序列。常用於主鍵的自動增長。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：序列應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個序列
CREATE SEQUENCE employee_seq
START WITH 207 -- 從 207 開始
INCREMENT BY 1 -- 每次增加 1
NOMAXVALUE -- 沒有最大值
NOCYCLE; -- 不循環

-- 使用序列插入資料
INSERT INTO employees (employee_id, first_name, last_name, email, hire_date, job_id, salary)
VALUES (employee_seq.NEXTVAL, 'New', 'Employee', 'NEMP', SYSDATE, 'SA_REP', 5000);

-- 查詢序列的當前值
SELECT employee_seq.CURRVAL FROM dual;

-- 刪除序列
DROP SEQUENCE employee_seq;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">14: 索引 (Indexes) - 提升查詢效能</h1>
    <p>索引是資料庫物件，用於提高資料檢索的速度。它們類似於書本的目錄。雖然可以加速查詢，但會增加資料修改（INSERT, UPDATE, DELETE）的開銷。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：索引應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立單一欄位索引
CREATE INDEX emp_last_name_idx ON employees (last_name);

-- 建立複合索引 (多個欄位)
CREATE INDEX emp_dept_job_idx ON employees (department_id, job_id);

-- 建立唯一索引 (確保欄位值唯一)
CREATE UNIQUE INDEX emp_email_uk ON employees (email);

-- 刪除索引
DROP INDEX emp_last_name_idx;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">15: 視圖 (Views) - 簡化複雜查詢</h1>
    <p>視圖是基於 SQL 查詢結果的虛擬資料表。它不儲存實際資料，而是儲存查詢定義。視圖可以簡化複雜查詢，限制資料存取，並提供資料獨立性。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：視圖應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個視圖，顯示高薪員工
CREATE VIEW high_salary_employees AS
SELECT employee_id, first_name, salary
FROM employees
WHERE salary &gt; 10000;

-- 查詢視圖 (像查詢普通資料表一樣)
SELECT * FROM high_salary_employees;

-- 刪除視圖
DROP VIEW high_salary_employees;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">16: 同義詞 (Synonyms) - 簡化物件名稱</h1>
    <p>同義詞是資料庫物件的別名。它們可以簡化對遠端資料庫物件或長物件名稱的引用，提高程式碼的可讀性和可維護性。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：同義詞應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個公共同義詞 (所有使用者都可以存取)
CREATE PUBLIC SYNONYM emp FOR employees;

-- 使用同義詞查詢資料
SELECT * FROM emp;

-- 刪除同義詞
DROP PUBLIC SYNONYM emp;</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">17: PL/SQL 基礎 - 程式化 SQL</h1>
    <p>PL/SQL (Procedural Language/SQL) 是 Oracle 對 SQL 的擴展，它結合了 SQL 的資料操作能力和程式語言的流程控制能力，用於撰寫儲存程序、函數、觸發器等。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：PL/SQL 區塊</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 匿名 PL/SQL 區塊
DECLARE
    v_employee_name employees.first_name%TYPE;
    v_employee_salary employees.salary%TYPE;
BEGIN
    SELECT first_name, salary
    INTO v_employee_name, v_employee_salary
    FROM employees
    WHERE employee_id = 100;

    DBMS_OUTPUT.PUT_LINE('員工姓名: ' || v_employee_name || ', 薪水: ' || v_employee_salary);
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('找不到員工。');
END;
/ -- 在 SQL*Plus 或 SQL Developer 中執行需要 /</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">18: 儲存程序 (Stored Procedures) - 可重用程式碼</h1>
    <p>儲存程序是儲存在資料庫中的命名 PL/SQL 區塊，可以接受參數並執行一系列 SQL 語句和 PL/SQL 邏輯。它們提高了效能、安全性和可重用性。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：儲存程序應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個儲存程序，根據員工 ID 增加薪水
CREATE OR REPLACE PROCEDURE increase_salary (
    p_employee_id IN employees.employee_id%TYPE,
    p_increase_amount IN NUMBER
) AS
BEGIN
    UPDATE employees
    SET salary = salary + p_increase_amount
    WHERE employee_id = p_employee_id;

    COMMIT; -- 提交事務
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK; -- 回滾事務
        RAISE_APPLICATION_ERROR(-20001, '更新薪水時發生錯誤: ' || SQLERRM);
END;
/

-- 執行儲存程序
EXEC increase_salary(100, 500);

-- 或者在 PL/SQL 區塊中執行
BEGIN
    increase_salary(101, 700);
END;
/</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">19: 函數 (Functions) - 返回單一值</h1>
    <p>函數是儲存在資料庫中的命名 PL/SQL 區塊，與儲存程序類似，但函數必須返回一個單一值。它們常用於計算或資料轉換。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：函數應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個函數，計算員工的年薪
CREATE OR REPLACE FUNCTION calculate_annual_salary (
    p_employee_id IN employees.employee_id%TYPE
) RETURN NUMBER IS
    v_annual_salary NUMBER;
BEGIN
    SELECT salary * 12
    INTO v_annual_salary
    FROM employees
    WHERE employee_id = p_employee_id;

    RETURN v_annual_salary;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN NULL;
END;
/

-- 在 SELECT 語句中使用函數
SELECT first_name, salary, calculate_annual_salary(employee_id) AS annual_salary
FROM employees
WHERE employee_id IN (100, 101);</code></pre></div>
    </div>

    <h1 class="SideTabs mt-4 pb-1" style="border-bottom: 1px solid #555;">20: 觸發器 (Triggers) - 自動化資料庫操作</h1>
    <p>觸發器是與資料表或視圖相關聯的 PL/SQL 區塊，當資料庫中發生特定事件（如 INSERT, UPDATE, DELETE）時會自動執行。它們常用於實施業務規則、資料稽核或維護資料完整性。</p>
    <div class="code-example bg-dark border border-secondary p-4 mb-4 rounded">
        <h4 class="text-white mb-3">SQL 範例：觸發器應用</h4>
        <div class="sql-code"><pre class="bg-secondary p-3 rounded text-light overflow-auto" style="font-size: 1.1em; line-height: 1.5; white-space: pre-wrap; word-break: break-all;"><code>-- 建立一個觸發器，在每次更新員工薪水前記錄舊薪水
CREATE TABLE salary_audit (
    audit_id NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    employee_id NUMBER,
    old_salary NUMBER,
    new_salary NUMBER,
    change_date DATE
);

CREATE OR REPLACE TRIGGER trg_salary_update
BEFORE UPDATE OF salary ON employees
FOR EACH ROW
BEGIN
    INSERT INTO salary_audit (employee_id, old_salary, new_salary, change_date)
    VALUES (:OLD.employee_id, :OLD.salary, :NEW.salary, SYSDATE);
END;
/

-- 測試觸發器 (更新薪水)
UPDATE employees
SET salary = salary + 100
WHERE employee_id = 100;

-- 查詢稽核表
SELECT * FROM salary_audit;</code></pre></div>
    </div>

</body>
</html>